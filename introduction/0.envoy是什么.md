# 什么是Envoy

Envoy 是一种 L7 代理和通信总线，专为大型现代面向服务的架构而设计。该项目的诞生源于以下信念：

> 网络应该对应用程序透明。当确实出现网络和应用程序问题时，应该很容易确定问题的根源。

在实践中，实现上述目标非常困难。Envoy 试图通过提供以下高级功能来做到这一点：

- 进程外架构: Envoy 是一个独立的进程，旨在与每个应用程序服务器一起运行,所有 Envoy 形成一个透明的通信网格，其中每个应用程序都在本地主机之间发送和接收消息，并且不知道网络拓扑。
- L3/L4 过滤器架构： Envoy 的核心是一个 L3/L4 网络代理。可插入的过滤器链机制允许编写过滤器来执行不同的 TCP/UDP 代理任务并插入到主服务器中。
- HTTP L7 过滤器架构： HTTP 是现代应用程序架构的关键组件，Envoy支持额外的 HTTP L7 过滤器层。HTTP 过滤器可以插入 HTTP 连接管理子系统，执行不同的任务，如缓冲、速率限制、路由/转发等
- 一流的 HTTP/2 支持：在 HTTP 模式下运行时，Envoy支持HTTP/1.1 和 HTTP/2。
- HTTP/3 支持（目前处于 alpha 阶段）：从 1.19.0 开始，Envoy 现在支持 HTTP/3 上游和下游，并在 HTTP/1.1、HTTP/2 和 HTTP/3 的任意组合之间进行双向转换。
- HTTP L7 路由：在 HTTP 模式下运行时，Envoy 支持路由子系统，该子系统能够根据路径、权限、内容类型、运行时值等路由和重定向请求。当使用 Envoy 作为前端/边缘时，此功能最有用代理，但在构建服务网格服务时也会被利用。
- gRPC 支持
- 服务发现和动态配置：Envoy 可选择使用一组分层的动态配置 API进行集中管理。
- 健康检查：构建 Envoy 网格的推荐方法是将服务发现视为最终一致的过程。Envoy 包括一个健康检查子系统，它可以选择性地对上游服务集群执行主动健康检查。然后，Envoy 使用服务发现和健康检查信息的结合来确定健康的负载均衡目标。Envoy 还支持通过异常值检测子系统进行被动健康检查。
- 高级负载均衡
- 前端/边缘代理支持
- 一流的可观察性：如上所述，Envoy 的主要目标是使网络透明。然而，问题出现在网络层面和应用层面。Envoy 包括对所有子系统的强大统计支持。statsd（和兼容的提供者）是当前支持的统计接收器，尽管插入不同的接收器并不困难。也可以通过管理端口查看统计信息。Envoy 还支持通过第三方提供商进行分布式跟踪。


